<!DOCTYPE html>
<html>
<head>
	<title>test</title>
	<script type="text/javascript" src="pixi.min.js"></script>

</head>
<body style = "font-size:0; padding:0; margin:0">
<script> 
	//make sure PIXI is working
	console.log(PIXI); 

	//initializes variables
	var cards = [];
	var blackCard;
	var state = firstFunc;
	var blackCardText = "";
	var mouseX, mouseY, oldPointerX, oldPointerY, mousehold;

	//SETUP
	//Create the renderer (DON'T CHANGE THIS USUALLY)
	var renderer = PIXI.autoDetectRenderer(256, 256, {antialias: false, transparent: false, resolution: 1});
	renderer.autoResize = true;
	//You can set certain css elements in the script
	renderer.view.style.position = "absolute";
	renderer.view.style.display = "block";
	renderer.resize(window.innerWidth, window.innerHeight);
	//Add the canvas to the HTML document
	document.body.appendChild(renderer.view);
	//Create a CONTAINER object called the `stage`
	var stage = new PIXI.Container(0x000000, true);
	
	function loadProgressHandler(loader, resource) {

		  //Display the file `url` and % currently being loaded
		  console.log("loading: " + resource.url); 
		  console.log("progress: " + loader.progress + "%"); 

		  //If you gave your files names as the first argument 
		  //of the `add` method, you can access them like this
		  //console.log("loading: " + resource.name);
		}

	//load all images used in stage
	PIXI.loader
		.add ('BlankCard.png')
		.add ('BlackCard.png')
		.on("progress", loadProgressHandler)
		.load (setup);
	

	//inherits PIXI.Sprite() and then configues some properties of it
	BlankCard.prototype = new PIXI.Sprite(); 
	function BlankCard(yPos){
		this.setTexture(PIXI.loader.resources["BlankCard.png"].texture);
		this.width = renderer.width;
		this.height = renderer.height;
		this.position.y = renderer.height+yPos+5;
		this.interactive = true;
		this.on('mousedown', ()=> {
			console.log('itWorks')
		});

		stage.addChild(this);
	}

	var firstPress = true;
	function detectSwipe(){
		if(firstPress){
			console.log( getLocalPosition(mouse));
		}
	}
	function setup() {
		renderer.backgroundColor = 0x003D30;
	    
	    for (let i = 0; i< 7; i++){
	        cards.push(new BlankCard(i*20));
	    }
	    
	    blackCard = new PIXI.Sprite(PIXI.loader.resources["BlackCard.png"].texture);
	    blackCard.width = renderer.width*1.07;
	    blackCard.position.x = -0.035*renderer.width;
	    blackCard.position.y = renderer.height;
	    blackCard.height = renderer.height*1.5;
	    blackCard.interactive=true;
		blackCard.on('mousedown', () => {oldPointerY = mouseY; mousehold=true;});
		blackCard.on('mousemove',dragBlack);
		blackCard.on('mouseup',()=>{mousehold=false;})
		blackCard.on('touchstart', () => {oldPointerY = mouseY; mousehold=true;});
		blackCard.on('touchmove',dragBlack);
		blackCard.on('touchend',()=>{mousehold=false;})
	    stage.addChild(blackCard);

	    gameLoop();
	}
	
	function dragBlack(){
		if(mousehold){
			blackCard.position.y=mouseY-150;
		} 
	}
	function resetBlackPos(x){
		if (blackCard.position.y - renderer.height*0.7 < -20 && x){
			blackCard.position.y+=renderer.height*0.1;
		}
		if (blackCard.position.y - renderer.height*0.7 > 20 && x){
			blackCard.position.y-=renderer.height*0.01;
		}
	}

	function firstFunc(){
		for (let i = 0; i<cards.length; i++){
			if (cards[i].y>i*10){
				cards[i].y-=renderer.height*0.01;
			}
		}
		resetBlackPos(!mousehold);
	}

	

	function gameLoop() {
		requestAnimationFrame(gameLoop);
		
		mouseX = renderer.plugins.interaction.mouse.global.x;
		mouseY = renderer.plugins.interaction.mouse.global.y;

		state();
		//Tell the `renderer` to `render` the `stage` (DO THIS LAST)
		renderer.render(stage);
	}





</script>
</body>
</html>